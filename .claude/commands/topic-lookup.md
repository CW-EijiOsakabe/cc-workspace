---
description: 過去のトピックから関連するものを検索して表示
---

# topic-lookup: トピック検索コマンド

受け取った文章に合致する過去のトピックを検索し、関連度順で5件ずつ表示するコマンドなのだ。

---

## User Input

```text
$ARGUMENTS
```

---

## パラメータ解析

User Inputから以下を抽出:

- **query**: 検索クエリ（必須）
- **page**: `--page N` オプションの値（デフォルト: 1）

例: `Figmaのデザイン管理 --page 2`
→ query: "Figmaのデザイン管理"
→ page: 2

---

## 実行手順

### Step 1: 全トピックの conclusion.md を収集

```bash
# topics/*/conclusion.md のパスを取得
ls topics/*/conclusion.md 2>/dev/null
```

### Step 2: 各 conclusion.md の内容を読み込み

各ファイルについて以下を抽出:
- **タイトル**: 最初の `# ` 見出し
- **概要**: 最初の段落または「## 概要」セクション
- **結論**: 「## 結論」セクションの最初の段落
- **タグ**: ファイル末尾の `タグ:` 行

### Step 3: 関連度スコアリング

検索クエリと各トピックの関連度をスコアリング:

| 評価項目 | 重み |
|----------|------|
| タイトルにクエリのキーワードが含まれる | 高 |
| 概要/結論にキーワードが含まれる | 中 |
| タグにキーワードが含まれる | 中 |
| 内容の文脈的な類似度 | 低 |

### Step 4: ソートとページネーション

1. 関連度スコアの高い順にソート
2. 指定されたページ番号に基づき、該当する5件を抽出
   - page 1: 1-5件目
   - page 2: 6-10件目
   - page N: ((N-1)*5+1) ~ (N*5)件目

---

## 出力形式

```
🔍 トピック検索結果: "<検索クエリ>"

---

### 1. <トピックタイトル>
📁 [conclusion.md](topics/YYYYMMDD_slug/conclusion.md)
📅 作成日: YYYY-MM-DD
🏷️ タグ: #tag1, #tag2

**概要**: <トピックの概要を2-3文で要約>

---

### 2. <トピックタイトル>
...

---

### 3. <トピックタイトル>
...

---

### 4. <トピックタイトル>
...

---

### 5. <トピックタイトル>
...

---

📄 表示中: 1-5件目 / 全N件

💡 次の5件を見るには:
   /topic-lookup <同じクエリ> --page 2
```

---

## 結果が0件の場合

```
🔍 トピック検索結果: "<検索クエリ>"

該当するトピックが見つからなかったのだ。

💡 ヒント:
- キーワードを変えて検索してみるのだ
- より一般的な用語で検索してみるのだ
- /topic-start で新しい調査を開始するのだ
```

---

## 最後のページの場合

```
📄 表示中: 11-15件目 / 全15件

✅ これが最後の結果なのだ！

💡 別のキーワードで検索するには:
   /topic-lookup <新しいクエリ>
```

---

## 完了条件

- [ ] 検索クエリに基づきトピックを検索
- [ ] 関連度順でソート
- [ ] 5件ずつ表示（ページネーション対応）
- [ ] 各トピックのリンクと概要を表示
- [ ] 次の5件の案内を表示（該当する場合）

---

## 注意事項

- 検索は conclusion.md の内容全体を対象とする
- 日本語・英語どちらのキーワードも対応
- 部分一致も考慮する
- 関連度が低すぎるトピックは除外する
- リンクは相対パスで表示（クリックで開けるようにする）
